jQuery.fn.extend({yoast_ga_graph:function(){"use strict";return this.each(function(){var a=jQuery(this),b=jQuery(a).attr("id"),c=document.getElementById(b),d={data:[],axis:{x:[],y:[]},width:780,height:300,graph:"",graph_axis:{x:"",y:""},graph_hover:[],init:function(){this.get_data(),this.add_events()},add_events:function(){var b=this;jQuery(a).on("graph_update",function(a,c){b.update(c,b)})},get_data:function(){var a={action:"yoast_dashboard_graphdata",_ajax_nonce:yoast_ga_dashboard_nonce,graph_id:b,period:"lastmonth"};jQuery.getJSON(ajaxurl,a,this.parse_response)},parse_response:function(a){d.set_data(a.data),void 0!==a.mapping.x&&d.set_x_axis_mapping(a.mapping.x),void 0!==a.mapping.y&&d.set_y_axis_mapping(a.mapping.y),d.create()},set_data:function(a){this.data=a},add_data:function(a){d.data.push(a)},set_x_axis_mapping:function(a){d.axis.x=a},add_x_axis_mapping:function(a){this.axis.x.push(a)},set_y_axis_mapping:function(a){d.axis.y=a},add_y_axis_mapping:function(a){this.axis.y.push(a)},create:function(){this.truncate_element(),this.create_graph(),this.create_axis(),this.create_hover(),this.render()},truncate_element:function(){a.find("> div").html("")},create_graph:function(){this.graph=new Rickshaw.Graph({element:c.querySelector(".yoast-graph-holder"),width:this.width,height:this.height,series:[{name:a.attr("data-label"),color:"steelblue",data:this.data}],renderer:"line",padding:{top:.05,left:0,right:0,bottom:.02}})},create_axis:function(){this.create_x_axis(),this.create_y_axis()},create_x_axis:function(){null!==c.querySelector(".yoast-graph-xaxis")&&(this.graph_axis.x=new Rickshaw.Graph.Axis.X({element:c.querySelector(".yoast-graph-xaxis"),graph:this.graph,grid:!0,tickFormat:this.format_axis_x,orientation:"bottom",pixelsPerTick:this.width/this.data.length}))},create_y_axis:function(){null!==c.querySelector(".yoast-graph-xaxis")&&(this.graph_axis.y=new Rickshaw.Graph.Axis.Y({element:c.querySelector(".yoast-graph-yaxis"),graph:this.graph,orientation:"left",tickValues:this.axis.y,height:"300",tickFormat:function(a){return 0===a?"":a}}))},create_hover:function(){this.graph_hover=new Rickshaw.Graph.HoverDetail({graph:this.graph,formatter:function(a,b,c){var d='<span class="detail_swatch" style="background-color: '+a.color+'"></span>',e=d+a.name+": "+parseInt(c,null)+"<br>";return e}})},render:function(){this.graph.render()},format_axis_x:function(a){return d.axis.x[a]},update:function(a,b){b.add_data(a.data),b.add_x_axis_mapping(a.mapping),b.graph.update(),b.render()}};d.init()})},yoast_ga_graph_update:function(a){"use strict";jQuery(this).trigger("graph_update",[a])}}),jQuery(function(){"use strict";jQuery(".yoast-graph").yoast_ga_graph()});